"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};exports.default=ConfigReducer;var _config=require("../actions/config.js"),_common=require("../actions/common.js"),_config2=require("../../utils/config.js");function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}var INITIAL_STATE={fixedIntroPane:!1,configBaseUrl:null,apigBaseUrl:null,integrations:[],imageUploadEnabled:!0,menuItems:{},soundNotificationEnabled:!0,integrationOrder:null,businessName:"",businessIconUrl:"",backgroundImageUrl:"",displayStyle:"",buttonIconUrl:null,buttonWidth:0,buttonHeight:0,colors:{brandColor:"888888",accentColor:"888888",linkColor:"888888"},isAppActive:!1,voiceConfig:{enabled:!1,voiceOnly:!1},brandedSdk:!0},COLORS=["brandColor","accentColor","linkColor"];function pickNonEmptyColors(e){var n={},t=!0,r=!1,o=void 0;try{for(var i,a=COLORS[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e[s]&&(n[s]=e[s])}}catch(e){r=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw o}}return n}function reduceWithRemoteSettings(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=e.integrationOrder;return!Array.isArray(t)&&Array.isArray(n.integrationOrder)&&(t=[].concat(_toConsumableArray(n.integrationOrder))),_extends({},e,{integrationOrder:t,displayStyle:e.displayStyle||n.displayStyle,buttonIconUrl:e.buttonIconUrl||n.buttonIconUrl,buttonWidth:e.buttonWidth||n.buttonWidth,buttonHeight:e.buttonHeight||n.buttonHeight,businessName:e.businessName||n.businessName,businessIconUrl:e.businessIconUrl||n.businessIconUrl,backgroundImageUrl:e.backgroundImageUrl||n.backgroundImageUrl,fixedIntroPane:e.fixedIntroPane||n.fixedIntroPane,colors:(0,_config2.computeColorsMetadata)(_extends({},pickNonEmptyColors(n),pickNonEmptyColors(e.colors)))})}function reduceWithLocalSettings(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return _extends({},e,{integrationOrder:Array.isArray(n.integrationOrder)?[].concat(_toConsumableArray(n.integrationOrder)):e.integrationOrder,displayStyle:n.displayStyle||e.displayStyle,buttonIconUrl:n.buttonIconUrl||e.buttonIconUrl,buttonWidth:n.buttonWidth||e.buttonWidth,buttonHeight:n.buttonHeight||e.buttonHeight,businessName:n.businessName||e.businessName,businessIconUrl:n.businessIconUrl||e.businessIconUrl,backgroundImageUrl:n.backgroundImageUrl||e.backgroundImageUrl,fixedIntroPane:n.fixedIntroPane||e.fixedIntroPane,colors:(0,_config2.computeColorsMetadata)(_extends({},pickNonEmptyColors(e.colors),pickNonEmptyColors(n)))})}function ConfigReducer(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:INITIAL_STATE,n=arguments[1];switch(n.type){case _common.RESET:case _config.RESET_CONFIG:return Object.assign({},INITIAL_STATE);case _config.SET_CONFIG:return _extends({},e,_defineProperty({},n.key,n.value));case _config.SET_LOCAL_SETTINGS:return reduceWithLocalSettings(e,n.settings);case _config.SET_REMOTE_SETTINGS:return reduceWithRemoteSettings(e,n.settings);default:return e}}