"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SET_REMOTE_SETTINGS=exports.SET_LOCAL_SETTINGS=exports.RESET_CONFIG=exports.SET_CONFIG=void 0;var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t};exports.setConfig=setConfig,exports.resetConfig=resetConfig,exports.setLocalSettings=setLocalSettings,exports.setRemoteSettings=setRemoteSettings,exports.fetchConfig=fetchConfig;var _index=require("../../../npm/redux-batched-actions/lib/index.js"),_http=require("./http.js"),_http2=_interopRequireDefault(_http),_config=require("../../utils/config.js");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var SET_CONFIG=exports.SET_CONFIG="SET_CONFIG",RESET_CONFIG=exports.RESET_CONFIG="RESET_CONFIG",SET_LOCAL_SETTINGS=exports.SET_LOCAL_SETTINGS="SET_LOCAL_SETTINGS",SET_REMOTE_SETTINGS=exports.SET_REMOTE_SETTINGS="SET_REMOTE_SETTINGS";function setConfig(t,e){return{type:SET_CONFIG,key:t,value:e}}function resetConfig(){return{type:RESET_CONFIG}}function setLocalSettings(t){return{type:SET_LOCAL_SETTINGS,settings:t}}function setRemoteSettings(t){return{type:SET_REMOTE_SETTINGS,settings:t}}function fetchConfig(){return function(i,t){var e=t().config,r=e.configBaseUrl,s=e.appId,o=e.apigBaseUrl,p=e.bypassApigBaseUrl;return i((0,_http2.default)("GET","/config/apps/"+s+"/config",{},{},r,!1)).then(function(t){var e=t.config,s=Object.keys(e).filter(function(t){return!["style","app"].includes(t)}).map(function(t){return setConfig(t,"integrations"===t?(0,_config.filterIntegrations)(e[t]):e[t])}),n=_extends({},e.style);e.app&&(e.app.name&&(n.businessName=e.app.name),e.app.iconUrl&&(n.businessIconUrl=e.app.iconUrl)),s.push(setConfig("displayStyle","button")),s.push(setRemoteSettings(n)),s.push(setConfig("isAppActive",e.app&&"active"===e.app.status)),s.push(setConfig("apigBaseUrl",o||"https://io-shared-apig.io.au.stackchat.com")),s.push(setConfig("bypassApigBaseUrl",p||r)),s.push(setConfig("identityPoolId",e.app.settings.identityProvider)),s.push(setConfig("brokerUrl",e.app.settings.brokerUrl)),i((0,_index.batchActions)(s))})}}