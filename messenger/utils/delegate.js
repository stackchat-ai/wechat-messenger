"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var DELEGATE_OPTIONS=["beforeDisplay","beforeSend","beforePostbackSend"];function oneLevelClone(t,n){var o=_extends({},t);return Object.keys(t).forEach(function(e){n[e]?o[e]=n[e](t[e]):"object"===_typeof(t[e])&&(o[e]=_extends({},t[e]))}),o}function cloneItem(e){return oneLevelClone(e,{actions:function(e){return e.map(oneLevelClone)}})}function cloneMessage(e){return oneLevelClone(e,{actions:function(e){return e.map(oneLevelClone)},items:function(e){return e.map(cloneItem)}})}var Delegate=exports.Delegate=function(){function e(){_classCallCheck(this,e),this.delegate={}}return _createClass(e,[{key:"setDelegate",value:function(n){if("object"!==(void 0===n?"undefined":_typeof(n)))throw new Error("setDelegate failed: delegate is not an object");var e=Object.keys(n).find(function(e){return!DELEGATE_OPTIONS.includes(e)});if(void 0!==e)throw new Error("setDelegate failed: invalid delegate option: "+e);Object.keys(n).forEach(function(e){var t=n[e];if("function"!=typeof t&&null!=t)throw new Error("setDelegate failed: delegate option "+e+" is an invalid type")}),this.delegate=n}},{key:"beforeDisplay",value:function(t){var e=t;if("function"==typeof this.delegate.beforeDisplay){try{e=this.delegate.beforeDisplay(cloneMessage(t))}catch(e){return console.error("Could not apply the 'beforeDisplay' transformation."),console.error(e),t}e?(e.id=t.id,e._isModifiedBeforeDisplay=!0):e=null}return e}},{key:"beforeSend",value:function(e){var t=e;if("function"!=typeof this.delegate.beforeSend)return t;t=cloneMessage(e);var n=this.delegate.beforeSend(e);return Object.assign(t,n)}},{key:"beforePostbackSend",value:function(e){var t=e;if("function"!=typeof this.delegate.beforePostbackSend)return t;t=cloneMessage(e);var n=this.delegate.beforePostbackSend(e);return Object.assign(t,n)}},{key:"hasBeforeDisplay",value:function(){return!(!this.delegate.beforeDisplay||"function"!=typeof this.delegate.beforeDisplay)}}]),e}(),delegate=exports.delegate=new Delegate;