"use strict";var Commons=require("./commons.js"),CustomEventTarget=require("./custom-event-target.js"),EventWrapper=require("./event-wrapper.js"),LISTENERS=Commons.LISTENERS,CAPTURE=Commons.CAPTURE,BUBBLE=Commons.BUBBLE,ATTRIBUTE=Commons.ATTRIBUTE,newNode=Commons.newNode,defineCustomEventTarget=CustomEventTarget.defineCustomEventTarget,createEventWrapper=EventWrapper.createEventWrapper,STOP_IMMEDIATE_PROPAGATION_FLAG=EventWrapper.STOP_IMMEDIATE_PROPAGATION_FLAG,HAS_EVENTTARGET_INTERFACE="undefined"!=typeof window&&void 0!==window.EventTarget,EventTarget=module.exports=function e(){if(!(this instanceof e)){if(1===arguments.length&&Array.isArray(arguments[0]))return defineCustomEventTarget(e,arguments[0]);if(0<arguments.length){for(var t=Array(arguments.length),n=0;n<arguments.length;++n)t[n]=arguments[n];return defineCustomEventTarget(e,t)}throw new TypeError("Cannot call a class as a function")}Object.defineProperty(this,LISTENERS,{value:Object.create(null)})};EventTarget.prototype=Object.create((HAS_EVENTTARGET_INTERFACE?window.EventTarget:Object).prototype,{constructor:{value:EventTarget,writable:!0,configurable:!0},addEventListener:{value:function(e,t,n){if(null==t)return!1;if("function"!=typeof t&&"object"!=typeof t)throw new TypeError('"listener" is not an object.');var r=n?CAPTURE:BUBBLE,o=this[LISTENERS][e];if(null==o)return this[LISTENERS][e]=newNode(t,r),!0;for(var E=null;null!=o;){if(o.listener===t&&o.kind===r)return!1;o=(E=o).next}return E.next=newNode(t,r),!0},configurable:!0,writable:!0},removeEventListener:{value:function(e,t,n){if(null==t)return!1;for(var r=n?CAPTURE:BUBBLE,o=null,E=this[LISTENERS][e];null!=E;){if(E.listener===t&&E.kind===r)return null==o?this[LISTENERS][e]=E.next:o.next=E.next,!0;E=(o=E).next}return!1},configurable:!0,writable:!0},dispatchEvent:{value:function(e){var t=this[LISTENERS][e.type];if(null==t)return!0;for(var n=createEventWrapper(e,this);null!=t&&("function"==typeof t.listener?t.listener.call(this,n):t.kind!==ATTRIBUTE&&"function"==typeof t.listener.handleEvent&&t.listener.handleEvent(n),!n[STOP_IMMEDIATE_PROPAGATION_FLAG]);)t=t.next;return!n.defaultPrevented},configurable:!0,writable:!0}});